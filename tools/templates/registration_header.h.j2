#pragma once

/**
 * AUTO-GENERATED FILE - DO NOT EDIT
 *
 * Generated by webbridge Registration Generator
 * Source: {{ header_path }}
 * 
 * DECLARATIONS ONLY - Implementations in {{ cls.name }}_registration.cpp
 */

#include <webview/webview.h>
#include <nlohmann/json.hpp>
#include "{{ header_path }}"

namespace webbridge::impl {
void register_{{ cls.name }}(webview::webview* w);
}

{% if cls.enums -%}
// =============================================================================
// JSON Serialization for Nested Enums (inline definitions)
// =============================================================================

{% for enum in cls.enums -%}
inline void to_json(nlohmann::json& j, const {{ cls.name }}::{{ enum.name }}& e) {
    switch (e) {
{% for value in enum.enum_values %}
        case {{ cls.name }}::{{ enum.name }}::{{ value }}: j = "{{ value }}"; break;
{% endfor %}
        default: j = nullptr; break;
    }
}

inline void from_json(const nlohmann::json& j, {{ cls.name }}::{{ enum.name }}& e) {
    const auto& name = j.get<std::string>();
{% for value in enum.enum_values %}
    {{ "if" if loop.first else "else if" }} (name == "{{ value }}") e = {{ cls.name }}::{{ enum.name }}::{{ value }};
{% endfor %}
    else {
        throw nlohmann::json::type_error::create(
            302,
            "Invalid enum value: '" + name + "' for type {{ cls.name }}::{{ enum.name }}",
            nullptr
        );
    }
}

{% endfor -%}
{% endif -%}
